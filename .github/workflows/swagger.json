{
	"openapi": "3.0.1",
	"info": {
		"title": "PFM",
		"version": "v1.0.0"
	},
	"servers": [{
		"url": "https://widgets.getxerpa.com/pfm-service/"
	}],
	"paths": {
		"/monitoring/health-check/": {
			"get": {
				"summary": "Health check",
				"operationId": "health_check",
				"description": "",
				"parameters": [],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Permite verificiar si el servicio está activo"
					}
				},
				"tags": [
					"Monitoreo"
				]
			}
		},
		"/monitoring/sentry/": {
			"get": {
				"summary": "Sentry",
				"operationId": "sentry",
				"description": "",
				"parameters": [],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Permite determinar si el servicio está conectado con Sentry."
					}
				},
				"tags": [
					"Monitoreo"
				]
			}
		},
		"/user/{userID}/budgets/": {
			"get": {
				"summary": "Presupuestos del usuario filtrados por mes",
				"operationId": "get_budgets_by_month",
				"description": "",
				"parameters": [{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "query",
						"name": "date_month",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Fecha",
						"example": "2021-09"
					}
				],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Permite obtener los Presupuestos del usuario filtrados por mes."
					}
				},
				"tags": [
					"Presupuestos"
				]
			},
            "post": {
                "summary": "Crear presupuesto",
                "operationId": "crear_presupuesto",
                "parameters": [
                    {
                        "in": "path",
                        "name": "userID",
                        "schema": {
                            "type": "string"
                        },
                        "required": true,
                        "description": "Id del usuario",
                        "example": "479ec168013945d0b7042bc4e5d0c4fb"
                    }
                ],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/Presupuesto"
							},
                            "examples": {
                                "Crear presupuesto": {
                                  "summary": "Ejemplo crear presupuesto monto",
                                  "value": {
                                        "amount": 9000,
										"user": "479ec168-0139-45d0-b704-2bc4e5d0c4fb",
										"category": "22118f55-e6a9-46b0-ae8f-a063dda396e0"
                                  }
                                }                      
                            }							
						}
					}
				},	
                "responses": {
                    "201": {
                        "description": "Created"
                    }
                },
                "tags": [
                    "Presupuestos"
                ]
            } 
		},			
		"/user/{userID}/budgets/categories/{categoryID}/": {
			"get": {
				"summary": "Presupuestos del usuario filtrados por categoría y por mes",
				"operationId": "get_budgets_by_category_month",
				"description": "",
				"parameters": [{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "path",
						"name": "categoryID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id de la categoría",
						"example": "22118f55-e6a9-46b0-ae8f-a063dda396e0"
					},
					{
						"in": "query",
						"name": "date_month",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Fecha",
						"example": "2021-09"
					}
				],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Permite obtener los Presupuestos del usuario filtrados por categoría y por mes."
					}
				},
				"tags": [
					"Presupuestos"
				]
			}
		},
		"/user/{userID}/budgets/{budgetID}/": {
			"get": {
				"summary": "Ver detalle del presupuesto",
				"operationId": "get_budget_detail",
				"description": "",
				"parameters": [
					{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "path",
						"name": "budgetID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del presupuesto",
						"example": "45a80dbbea714ce390b3-6761bcbf365c"
					}
				],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Obtener detalle del presupuesto"
					}
				},
				"tags": [
					"Presupuestos"
				]
			},
			"patch": {
				"summary": "Actualizar presupuesto parcialmente.",
				"operationId": "update_budget",
				"description": "",
				"parameters": [
					{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "path",
						"name": "budgetID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del presupuesto",
						"example": "45a80dbbea714ce390b3-6761bcbf365c"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/Presupuesto"
							},
                            "examples": {
                                "Actualizar monto": {
                                  "summary": "Ejemplo actualizar monto",
                                  "value": {
                                        "amount": 9000
                                  }
                                }                      
                            }							
						}
					}
				},			
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Actualizar presupuesto"
					}
				},
				"tags": [
					"Presupuestos"
				]
			},
			"put": {
				"summary": "Actualizar presupuesto.",
				"operationId": "update_budget_put",
				"description": "",
				"parameters": [
					{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "path",
						"name": "budgetID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del presupuesto",
						"example": "45a80dbbea714ce390b3-6761bcbf365c"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/Presupuesto"
							},
                            "examples": {
                                "Actualizar monto": {
                                  "summary": "Ejemplo actualizar monto",
                                  "value": {
									  "user": "479ec168013945d0b7042bc4e5d0c4fb",
									  "amount": 10000,
									  "category": "22118f55-e6a9-46b0-ae8f-a063dda396e0"
                                  }
                                }                      
                            }								
						}
					}
				},				
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Update budget"
					}
				},
				"tags": [
					"Presupuestos"
				]
			}			
		},
		"/user/{userID}/transactions/": {
			"get": {
				"summary": "Transacciones del usuario filtrados por mes",
				"operationId": "get_transactions_by_month",
				"description": "",
				"parameters": [{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "query",
						"name": "date_month",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Fecha",
						"example": "2021-09"
					}
				],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Permite obtener las transacciones del usuario filtrados por mes."
					}
				},
				"tags": [
					"Transacciones"
				]
			}
		},
		"/user/{userID}/transactions/categories/{categoryID}/": {
			"get": {
				"summary": "Transacciones del usuario filtrados por categoría y por mes",
				"operationId": "get_transactions_by_category_month",
				"description": "",
				"parameters": [{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "path",
						"name": "categoryID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id de la categoría",
						"example": "9abd4759-ab14-4e09-adc2-9c5dea1041b1"
					},
					{
						"in": "query",
						"name": "date_month",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Fecha",
						"example": "2021-09"
					}
				],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Permite obtener los Presupuestos del usuario filtrados por categoría y por mes."
					}
				},
				"tags": [
					"Transacciones"
				]
			}
		},		
		"/user/{userID}/transactions/{transactionID}/": {
			"get": {
				"summary": "Ver detalle de la transacción",
				"operationId": "get_transaction_detail",
				"description": "",
				"parameters": [
					{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "b9e605ee-4cca-400e-99c5-ae24abca97d5"
					},
					{
						"in": "path",
						"name": "transactionID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id de la transacción",
						"example": "c7e78eb2-4bef-4dde-b61c-822fe0257003"
					}
				],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Obtener detalle de la transacción"
					}
				},
				"tags": [
					"Transacciones"
				]
			},
			"patch": {
				"summary": "Actualizar transacción parcialmente.",
				"operationId": "update_transaction",
				"description": "",
				"parameters": [
					{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "b9e605ee-4cca-400e-99c5-ae24abca97d5"
					},
					{
						"in": "path",
						"name": "transactionID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id de la transacción",
						"example": "c7e78eb2-4bef-4dde-b61c-822fe0257003"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/Transaccion"
							},
                            "examples": {
                                "Actualizar nota": {
                                  "summary": "Ejemplo actualizar nota",
                                  "value": {
                                        "user_note": "Nota del usuario"
                                  }
                                }                      
                            }							
						}
					}
				},			
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Actualizar transacción"
					}
				},
				"tags": [
					"Transacciones"
				]
			},
			"put": {
				"summary": "Actualizar presupuesto.",
				"operationId": "update_transaction_put",
				"description": "",
				"parameters": [
					{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "b9e605ee-4cca-400e-99c5-ae24abca97d5"
					},
					{
						"in": "path",
						"name": "transactionID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id de la transacción",
						"example": "c7e78eb2-4bef-4dde-b61c-822fe0257003"
					}
				],
				"requestBody": {
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/Transaccion"
							},
                            "examples": {
                                "Actualizar descripcion": {
                                  	"summary": "Ejemplo actualizar monto",
                                  	"value": {
									  	"category": "22118f55-e6a9-46b0-ae8f-a063dda396e0",
										"description": "Descripción transacción.",
										"transaction_date": "2021-09-09T15:20:30-04:00",
										"account": "910e8abd-1265-41ba-8125-f6c720bacde9",
										"amount": 4000
                                  	}
                                }                      
                            }								
						}
					}
				},				
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Actualizar transacción"
					}
				},
				"tags": [
					"Transacciones"
				]
			}			
		},
		"/user/{userID}/transactions/summary/": {
			"get": {
				"summary": "Gasto Total mensual",
				"operationId": "get_summary",
				"description": "",
				"parameters": [
					{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "query",
						"name": "date_month",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Fecha",
						"example": "2021-09"
					}					
				],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Permite obtener el gasto total mensual."
					}
				},
				"tags": [
					"Transacciones"
				]
			}
		},
		"/user/{userID}/transactions/expenses/summary/": {
			"get": {
				"summary": "Gasto Total de egresos",
				"operationId": "get_expenses_summary",
				"description": "",
				"parameters": [
					{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "query",
						"name": "date_month",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Fecha",
						"example": "2021-09"
					}					
				],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Permite obtener el gasto total de egresos."
					}
				},
				"tags": [
					"Transacciones"
				]
			}
		},
		"/user/{userID}/transactions/balance/": {
			"get": {
				"summary": "Balance Mensual",
				"operationId": "get_balance",
				"description": "",
				"parameters": [
					{
						"in": "path",
						"name": "userID",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Id del usuario",
						"example": "479ec168013945d0b7042bc4e5d0c4fb"
					},
					{
						"in": "query",
						"name": "year",
						"schema": {
							"type": "string"
						},
						"required": true,
						"description": "Fecha",
						"example": "2021"
					}					
				],
				"responses": {
					"200": {
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {}
								}
							}
						},
						"description": "Permite obtener el gasto total de egresos."
					}
				},
				"tags": [
					"Transacciones"
				]
			}
		}
	},
	"components": {
		"schemas": {
			"Presupuesto": {
				"title": "Presupuesto ",
				"type": "object",
				"properties": {
					"user": {
						"type": "string",
						"description": "Id del usuario"
					},
					"category": {
						"type": "string",
						"description": "Id de la categoria"
					},
					"amount": {
						"type": "number",
						"description": "Monto"
					},
					"budget_date": {
						"type": "string",
						"description": "Fecha"
					}
				},
				"required": [
					"user",
					"project",
					"amount",
					"category"
				]
			},
			"Transaccion": {
				"title": "Transacción ",
				"type": "object",
				"properties": {
					"account": {
						"type": "string",
						"description": "Cuenta del usuario"
					},
					"category": {
						"type": "string",
						"description": "Id de la categoria"
					},
					"amount": {
						"type": "number",
						"description": "Monto"
					},
					"description": {
						"type": "string",
						"description": "description"
					},
					"transaction_date": {
						"type": "string",
						"description": "Fecha"
					},
					"user_note": {
						"type": "string",
						"description": "Nota del usuario"
					}
				}
			}		
		}
	}
}
